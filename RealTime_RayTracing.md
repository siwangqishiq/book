## 实时光线追踪

比起《实时渲染》在大部分章节所介绍的基于光栅化的渲染技术,光线追踪是一种更加直接的,基于物理光线模拟的渲染算法,它可以生成更加真实的图像。在1999年《实时渲染》这本书一版时，我们曾预计在2007到2024年，虫虫作战可以达到平均每秒12帧的渲染效率.在某种意义上,我们是对的.虫虫大作战在一些的确需要的场景下使用了光线追踪,例如:一滴水的折射与反射.然而，随着最近几年GPU的进步,我们已经可以使用实时的光线追踪渲染出类似游戏的场景.例如:本书的封面所展示的场景，它以每秒20帧,实现了全局光照.光线追踪将会引发实时渲染领域的革命. 

从最简单的形式出发,对于可见性判定,无论是光栅化还是光线追踪，都可以描述为两个for循环的形式.
光栅化: 
```
for(三角形 : 场景中的所有三角形)
    for(像素点 : 屏幕上的所有像素点)
        判断 像素点 是否在三角形中
```
光线追踪:
```
for(像素点 : 屏幕上所有的像素点)
    for(三角形 : 场景中的所有三角形)
        判断 穿过像素点的射线 与 三角形有交点
```

某种意义上,他们都是较为简单的算法.为了让其运行的更快,你需要更多的代码和硬件. 光线追踪器使用的一个重要特性是空间数据结构,比如水平方向的包围体(BVH),追踪一条光线的运行时间是 $O(log n)$ , $n$ 代表场景中的三角形数量.尽管这是光线追踪一个吸引人的特性,但是很明显,光栅化也比 $O(n)$ 更好,因为GPU有硬件实现的遮挡剔除,游戏引擎也有使用视锥体的剔除算法,延迟着色以及许多其他的技术以避免处理所有的图元.所以使用大$O$表示法来估计光栅化的运行时间是较为复杂的.顺便一提,在GPU上三角形的遍历及纹理单元的访问是非常快的,并且光栅化方法已经优化过十几年了.





